#Generated by Kickstart Configurator
#platform=x86

#System language
lang en_US
#Language modules to install
langsupport en_US
#System keyboard
keyboard us
#System mouse
mouse
#System timezone
timezone Europe/Kiev
#Root password
rootpw --iscrypted $1$z6iCsNvU$LZ3Hfo5R/5wycVCKVnoQs/
#Initial user
user --disabled
#Reboot after installation
reboot
#Use text mode install
text
#Install OS instead of upgrade
install
#Use CDROM installation media
cdrom
#System bootloader configuration
bootloader --location=mbr 
#Clear the Master Boot Record
zerombr yes
#Partition clearing information
clearpart --all --initlabel 
#Disk partitioning information
part / --fstype ext4 --size 50000 
part /boot --fstype ext4 --size 1000 
part swap --size 8000 
#System authorization infomation
auth  --useshadow  --enablemd5 
#Network information
network --bootproto=dhcp --device=eth0
#Firewall configuration
firewall --disabled 
#Run the Setup Agent on first boot
firstboot --enable
#Do not configure the X Window System
skipx
#Package install information
%packages
kexec-tools
%end
%addon com_redhat_kdump --enable --reserve-mb='auto'
%end
%anaconda
pwpolicy root --minlen=6 --minquality=1 --notstrict --nochanges --notempty
pwpolicy user --minlen=6 --minquality=1 --notstrict --nochanges --emptyok
pwpolicy luks --minlen=6 --minquality=1 --notstrict --nochanges --notempty
%end
%pre --interpreter=
%post
#!/bin/bash
lsblk

mkfs.ext4  /dev/sdc1
pvcreate /dev/sdb4 /dev/sdc1

vgcreate vg0 /dev/sdc1
lvcreate -n lv_jenkins -L 500G data /dev/sdc1
mkfs.ext4  /dev/vg0/lv_jenkins
vgextend vg0 /dev/sdb4
lvcreate -n lv_cache_meta -L 1G  vg0 /dev/sdb4
lvcreate -L 50G -n lv_cache vg0 /dev/sdd4
lvconvert --type cache-pool  --cachemode writeback --poolmetadata vg0/lv_cache_meta vg/lv_cache
lvconvert --type cache --cachepool vg0/lv_cache vg0/lv_jenkins

yum -y update
